/*
 * test.c
 *
 *  Created on: 2012-3-19
 *      Author: nacle
 */
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#include "debug.h"
#include "gmp.h"
#include "sm2_func.h"
#include "base_tools.h"
// 私钥 C4A11B2F08CB0EAACC3B7E9BB4A72EA0AA300F1FCEF6E1013A4040DB634F59DE
// 公钥 E6A10F57B1CFC8E94657D63157EC888FB570A6E0EFFBF9E37CDEF430ACAADEEF413F089B27D1BB51B3E99A35FC68F873E6649541CEB243342DA51B4DAF7C9299

static char* pkx= "E6A10F57B1CFC8E94657D63157EC888FB570A6E0EFFBF9E37CDEF430ACAADEEF";
static char* pky= "413F089B27D1BB51B3E99A35FC68F873E6649541CEB243342DA51B4DAF7C9299";
static char* data = "7031B785B0D12E5B3775625D74CDF785FBB64227690F195AE2D19B08A8B8D81965F748C352E206D6E1732E8D99318804CA659304329BFC10CAF3671A1E6E7A6975C374FCA746D771CAC73E6B61D23FCDC1297972FA8E0AC3A940A9DD018C59292353DFE50934EFF9865A73D4E0581B9170DC28775397C5AEDD5F2A7B1C66A08E4A9D8BF548F38C556128D355849C86C20F6F67EFD769053CDE88082476CBBD01223560E28BA58F88B3FD48D9D595151F83E43DB3CCCD5CDB5860802D5BEFA98CDB0247EDAE5365A50CE1643C75312E0CDD00E12F534BDF60476762A564274B67E96D5B9D54B1B1ECC3F0B091068D1ECC35AAF521E4DA828190DA6944FAD6E0D4CAAB4CC2BF00EB1D8F8523C97A0A99E1BB4FD14E88676ADD40B60AF8333ABF0CAE48071DF91816DDCD56E5B73CFFFA4657B458833C96C97F0B0F88D04FAEEB6DF7E198BAA5061BC70C9E119A75B0E99996677F2FF346C1604326A134F92A7B2B7ECB454E79D737193574B3C196F023D8EE6C096BCF50F8BBEB0079E75DC85D8457E926D4208CCB759C43CA08982A7D6BA7089C4D09AFC7D2112A80547C1C57B3A9F9A066EA278FF08D2E4EDE4777A6694F0B010E3AEA8BE5C204923C38E74C982AFBA4A179D8AA75CA8217D96F29154EC5AC45501973F2629A735EA0E5EF29C1AA3B4260286D542CF5153A65617D5144733893DFF2810420D3436EC38E704F7853714DA17748BFA3925AAE33A041DE87A8F0ECA20C75585A5E8331954A7571DCA2051223F816104113BCE85F14211564EF44C64F004F1DCAD922225952B06CAAA78BCEC474BDB08EEA762651D542D8B0E4D37B63E739B8BFC1C67908CDB69B6494D7576FF8D2AD3D6ACDADDE1629777C21BE19171D0AB0A891127637E9821A61D527FD7A811BD65D6F274C1F343E4E7E2603E6ED5C99249773D5C279D976852C33A022F3DD20492C6D3B9E933FDDC3376D261377BB39E35A1BA62496D8E22EE375DA50626E6E2852750ADC4A8BDB86F3652900A3BED394E0585E661489E829D3D687AD8C17DB52A5117EC3647B63D2BB4B43DFCE5A72B2F39DEECFA65E4D4E323B66F311C0755A2B615857E770D4EFD1EDFB54A0BF51FBC6ADAE0DB8FC585EB0C13211604AB68A49003695312A3983E5973A91C6E61D64FE583CBB7E99388ECD9E25988136765B0C5371188692C6A29A585FE0B111936A032AE273093E2F7CEA0DC4D55354F5BBF9CAEE0C6CA212F4B04BA7749BCEEFC313CDBD52213FFD98BBAA45F0294B30B6DAD97D9F8732AB941DE80BD2A166F23723DF1A82203FC611BAED769BEEE9CC257C1824C57E9ED3DEDC88DB3BD23C10D493B735CAE5AB456165E1DC9425E83C29830C4BEF9517E61825958D4510966D05EA92E3FFD1E51E13E572F3D126B9929414";

gmp_randstate_t stat;


void test(int cnt){
	printf("%d *************************************************\n\n", cnt);
	
	UBYTE* result=NULL;
	ULONG msglen = strlen(data)/2;
	ULONG len = sm2_encrypt(256, pkx, pky, data, msglen, &result);
#ifdef DEBUG_PRINT
	int i;
	printf("test.result %x= [", result);
	for(i=0; i<len; i++)
	{
		printf("%02X", result[i]);
	}	
	printf("]\n");
	printf("free result::%X\n", (result));
#endif
	free(result);
	result=NULL;
}

int main(){
	int i;
	for (i=1; i<100000; i++)
	{
		test(i);
	}	
	return 0;
}
